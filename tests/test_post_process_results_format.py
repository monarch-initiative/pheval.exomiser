import unittest
from copy import copy
from unittest.mock import patch

from pheval.post_processing.post_processing import (
    PhEvalDiseaseResult,
    PhEvalGeneResult,
    PhEvalVariantResult,
)

from pheval_exomiser.post_process.post_process_results_format import (
    PhEvalDiseaseResultFromExomiserJsonCreator,
    PhEvalGeneResultFromExomiserJsonCreator,
    PhEvalVariantResultFromExomiserJsonCreator,
)

example_exomiser_result = [
    {
        "geneSymbol": "PLXNA1",
        "geneIdentifier": {
            "geneId": "ENSG00000114554",
            "geneSymbol": "PLXNA1",
            "hgncId": "HGNC:9099",
            "hgncSymbol": "PLXNA1",
            "entrezId": "5361",
            "ensemblId": "ENSG00000114554",
            "ucscId": "uc003ejg.3",
        },
        "combinedScore": 0.048419416654489886,
        "priorityScore": 0.500087835782324,
        "variantScore": 0.5566032528877258,
        "pValue": 0.18761854103343464,
        "priorityResults": {
            "HIPHIVE_PRIORITY": {
                "priorityType": "HIPHIVE_PRIORITY",
                "geneId": 5361,
                "geneSymbol": "PLXNA1",
                "score": 0.500087835782324,
                "ppiScore": 0.500087835782324,
                "queryPhenotypeTerms": [
                    {"id": "HP:0000256", "label": "Macrocephaly"},
                    {"id": "HP:0002059", "label": "Cerebral atrophy"},
                    {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                    {"id": "HP:0003150", "label": "Glutaric aciduria"},
                    {"id": "HP:0001332", "label": "Dystonia"},
                ],
                "phenotypeEvidence": [
                    {
                        "score": 0.2201534815163801,
                        "model": {
                            "organism": "MOUSE",
                            "entrezGeneId": 5361,
                            "humanGeneSymbol": "PLXNA1",
                            "modelGeneId": "MGI:107685",
                            "modelGeneSymbol": "Plxna1",
                            "phenotypeIds": ["MP:0000953"],
                            "id": "MGI:107685_MGI:3831891",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0002059", "label": "Cerebral atrophy"},
                                "match": {
                                    "id": "MP:0000953",
                                    "label": "abnormal oligodendrocyte morphology",
                                },
                                "lcs": {
                                    "id": "HP:0002011",
                                    "label": "Morphological central nervous system abnormality",
                                },
                                "ic": 2.564961484335766,
                                "simj": 0.3076923076923077,
                                "score": 0.888379940260449,
                            },
                            {
                                "query": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "match": {
                                    "id": "MP:0000953",
                                    "label": "abnormal oligodendrocyte morphology",
                                },
                                "lcs": {
                                    "id": "HP:0002011",
                                    "label": "Morphological central nervous system abnormality",
                                },
                                "ic": 2.564961484335766,
                                "simj": 0.2222222222222222,
                                "score": 0.7549777751454035,
                            },
                        ],
                    }
                ],
                "ppiEvidence": [
                    {
                        "score": 0.37302057935946703,
                        "model": {
                            "organism": "HUMAN",
                            "disease": {
                                "diseaseId": "ORPHA:33001",
                                "diseaseName": "Lymphedema-distichiasis syndrome",
                                "associatedGeneId": 2303,
                                "diseaseType": "DISEASE",
                                "inheritanceMode": "AUTOSOMAL_DOMINANT",
                                "phenotypeIds": [
                                    "HP:0000010",
                                    "HP:0000075",
                                    "HP:0000093",
                                    "HP:0000175",
                                    "HP:0000204",
                                    "HP:0000465",
                                    "HP:0000508",
                                    "HP:0000509",
                                    "HP:0000518",
                                    "HP:0000613",
                                    "HP:0000656",
                                    "HP:0000819",
                                    "HP:0001324",
                                    "HP:0001581",
                                    "HP:0001643",
                                    "HP:0001970",
                                    "HP:0002619",
                                    "HP:0003550",
                                    "HP:0004930",
                                    "HP:0009743",
                                    "HP:0009745",
                                    "HP:0011675",
                                    "HP:0100244",
                                    "HP:0100820",
                                    "HP:0200020",
                                ],
                                "id": "ORPHA:33001",
                                "associatedGeneSymbol": "FOXC2",
                            },
                            "entrezGeneId": 2303,
                            "humanGeneSymbol": "FOXC2",
                            "diseaseId": "ORPHA:33001",
                            "diseaseTerm": "Lymphedema-distichiasis syndrome",
                            "phenotypeIds": [
                                "HP:0000010",
                                "HP:0000075",
                                "HP:0000093",
                                "HP:0000175",
                                "HP:0000204",
                                "HP:0000465",
                                "HP:0000508",
                                "HP:0000509",
                                "HP:0000518",
                                "HP:0000613",
                                "HP:0000656",
                                "HP:0000819",
                                "HP:0001324",
                                "HP:0001581",
                                "HP:0001643",
                                "HP:0001970",
                                "HP:0002619",
                                "HP:0003550",
                                "HP:0004930",
                                "HP:0009743",
                                "HP:0009745",
                                "HP:0011675",
                                "HP:0100244",
                                "HP:0100820",
                                "HP:0200020",
                            ],
                            "id": "ORPHA:33001_2303",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "HP:0000093", "label": "Proteinuria"},
                                "lcs": {
                                    "id": "HP:0033354",
                                    "label": "Abnormal urine metabolite level",
                                },
                                "ic": 4.187537448397988,
                                "simj": 0.5555555555555556,
                                "score": 1.5252572548768413,
                            },
                            {
                                "query": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "match": {"id": "HP:0002619", "label": "Varicose veins"},
                                "lcs": {
                                    "id": "HP:0025015",
                                    "label": "Abnormal vascular morphology",
                                },
                                "ic": 2.9688246275384604,
                                "simj": 0.25,
                                "score": 0.8615138750389427,
                            },
                        ],
                    },
                    {
                        "score": 0.6557657231285885,
                        "model": {
                            "organism": "MOUSE",
                            "entrezGeneId": 2303,
                            "humanGeneSymbol": "FOXC2",
                            "modelGeneId": "MGI:1347481",
                            "modelGeneSymbol": "Foxc2",
                            "phenotypeIds": [
                                "MP:0000029",
                                "MP:0000111",
                                "MP:0000141",
                                "MP:0000154",
                                "MP:0000163",
                                "MP:0000431",
                                "MP:0001614",
                                "MP:0001691",
                                "MP:0001915",
                                "MP:0002400",
                                "MP:0002989",
                                "MP:0003345",
                                "MP:0003400",
                                "MP:0004204",
                                "MP:0004318",
                                "MP:0004384",
                                "MP:0004443",
                                "MP:0004445",
                                "MP:0004447",
                                "MP:0004449",
                                "MP:0004456",
                                "MP:0004476",
                                "MP:0004592",
                                "MP:0004599",
                                "MP:0005105",
                                "MP:0005587",
                                "MP:0006020",
                                "MP:0006054",
                                "MP:0008380",
                                "MP:0011108",
                                "MP:0030026",
                                "MP:0030121",
                            ],
                            "id": "MGI:1347481_MGI:2170157",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "match": {"id": "MP:0004384", "label": "small interparietal bone"},
                                "lcs": {"id": "MP:0000438", "label": "abnormal cranium morphology"},
                                "ic": 2.555277672562376,
                                "simj": 0.68,
                                "score": 1.3181763225541625,
                            },
                            {
                                "query": {"id": "HP:0002059", "label": "Cerebral atrophy"},
                                "match": {"id": "MP:0003400", "label": "kinked neural tube"},
                                "lcs": {
                                    "id": "HP:0002011",
                                    "label": "Morphological central nervous system abnormality",
                                },
                                "ic": 2.564961484335766,
                                "simj": 0.32,
                                "score": 0.9059733301744842,
                            },
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "MP:0002989", "label": "small kidney"},
                                "lcs": {
                                    "id": "HP:0000079",
                                    "label": "Abnormality of the urinary system",
                                },
                                "ic": 3.4863678415566968,
                                "simj": 0.23333333333333334,
                                "score": 0.9019344930185133,
                            },
                            {
                                "query": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "match": {"id": "MP:0001915", "label": "intracranial hemorrhage"},
                                "lcs": {"id": "MP:0001915", "label": "intracranial hemorrhage"},
                                "ic": 7.415808888728614,
                                "simj": 0.9655172413793104,
                                "score": 2.675834699835067,
                            },
                        ],
                    },
                ],
                "mouseScore": 0.2201534815163801,
            },
            "OMIM_PRIORITY": {
                "priorityType": "OMIM_PRIORITY",
                "geneId": 5361,
                "geneSymbol": "PLXNA1",
                "score": 1.0,
                "scoresByMode": {
                    "AUTOSOMAL_DOMINANT": 1.0,
                    "AUTOSOMAL_RECESSIVE": 1.0,
                    "X_RECESSIVE": 0.5,
                    "X_DOMINANT": 0.5,
                    "MITOCHONDRIAL": 0.5,
                },
            },
        },
        "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
        "geneScores": [
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "AUTOSOMAL_DOMINANT",
                "combinedScore": 0.048419416654489886,
                "phenotypeScore": 0.500087835782324,
                "variantScore": 0.5566032528877258,
                "pValue": 0.18761854103343464,
                "contributingVariants": [
                    {
                        "genomeAssembly": "HG19",
                        "contigName": "3",
                        "start": 126730873,
                        "end": 126730873,
                        "ref": "G",
                        "alt": "A",
                        "id": "rs78052417",
                        "type": "SNV",
                        "length": 1,
                        "phredScore": 2970.4399999999996,
                        "variantEffect": "MISSENSE_VARIANT",
                        "filterStatus": "PASSED",
                        "contributesToGeneScore": True,
                        "variantScore": 0.55660325,
                        "frequencyScore": 0.9972702,
                        "pathogenicityScore": 0.5581268,
                        "predictedPathogenic": True,
                        "passedFilterTypes": [
                            "FAILED_VARIANT_FILTER",
                            "PATHOGENICITY_FILTER",
                            "FREQUENCY_FILTER",
                            "VARIANT_EFFECT_FILTER",
                            "INHERITANCE_FILTER",
                        ],
                        "frequencyData": {
                            "rsId": "rs78052417",
                            "knownFrequencies": [
                                {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                {"source": "TOPMED", "frequency": 0.001133},
                                {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                                {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                            ],
                            "score": 0.9972702,
                        },
                        "pathogenicityData": {
                            "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                            "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                            "score": 0.5581268,
                            "predictedPathogenicityScores": [
                                {"source": "REVEL", "score": 0.348},
                                {"source": "MVP", "score": 0.5581268},
                            ],
                        },
                        "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
                        "contributingInheritanceModes": [
                            "AUTOSOMAL_DOMINANT",
                            "AUTOSOMAL_RECESSIVE",
                        ],
                        "transcriptAnnotations": [
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000251772.4",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2116G>A",
                                "hgvsProtein": "p.(Ala706Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000393409.2",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2185G>A",
                                "hgvsProtein": "p.(Ala729Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                        ],
                    }
                ],
                "acmgAssignments": [
                    {
                        "variantEvaluation": {
                            "genomeAssembly": "HG19",
                            "contigName": "3",
                            "start": 126730873,
                            "end": 126730873,
                            "ref": "G",
                            "alt": "A",
                            "id": "rs78052417",
                            "type": "SNV",
                            "length": 1,
                            "phredScore": 2970.4399999999996,
                            "variantEffect": "MISSENSE_VARIANT",
                            "filterStatus": "PASSED",
                            "contributesToGeneScore": True,
                            "variantScore": 0.55660325,
                            "frequencyScore": 0.9972702,
                            "pathogenicityScore": 0.5581268,
                            "predictedPathogenic": True,
                            "passedFilterTypes": [
                                "FAILED_VARIANT_FILTER",
                                "PATHOGENICITY_FILTER",
                                "FREQUENCY_FILTER",
                                "VARIANT_EFFECT_FILTER",
                                "INHERITANCE_FILTER",
                            ],
                            "frequencyData": {
                                "rsId": "rs78052417",
                                "knownFrequencies": [
                                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                    {"source": "TOPMED", "frequency": 0.001133},
                                    {
                                        "source": "EXAC_NON_FINNISH_EUROPEAN",
                                        "frequency": 0.004534462,
                                    },
                                    {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                                ],
                                "score": 0.9972702,
                            },
                            "pathogenicityData": {
                                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                                "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                                "score": 0.5581268,
                                "predictedPathogenicityScores": [
                                    {"source": "REVEL", "score": 0.348},
                                    {"source": "MVP", "score": 0.5581268},
                                ],
                            },
                            "compatibleInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "contributingInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "transcriptAnnotations": [
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000251772.4",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2116G>A",
                                    "hgvsProtein": "p.(Ala706Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000393409.2",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2185G>A",
                                    "hgvsProtein": "p.(Ala729Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                            ],
                        },
                        "geneIdentifier": {
                            "geneId": "ENSG00000114554",
                            "geneSymbol": "PLXNA1",
                            "hgncId": "HGNC:9099",
                            "hgncSymbol": "PLXNA1",
                            "entrezId": "5361",
                            "ensemblId": "ENSG00000114554",
                            "ucscId": "uc003ejg.3",
                        },
                        "modeOfInheritance": "AUTOSOMAL_DOMINANT",
                        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
                        "acmgEvidence": {"empty": True},
                        "acmgClassification": "PATHOGENIC",
                    }
                ],
            },
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "AUTOSOMAL_RECESSIVE",
                "combinedScore": 0.04598293574097189,
                "phenotypeScore": 0.500087835782324,
                "variantScore": 0.5507028996944427,
                "pValue": 0.19066565349544073,
                "contributingVariants": [
                    {
                        "genomeAssembly": "HG19",
                        "contigName": "3",
                        "start": 126730873,
                        "end": 126730873,
                        "ref": "G",
                        "alt": "A",
                        "id": "rs78052417",
                        "type": "SNV",
                        "length": 1,
                        "phredScore": 2970.4399999999996,
                        "variantEffect": "MISSENSE_VARIANT",
                        "filterStatus": "PASSED",
                        "contributesToGeneScore": True,
                        "variantScore": 0.55660325,
                        "frequencyScore": 0.9972702,
                        "pathogenicityScore": 0.5581268,
                        "predictedPathogenic": True,
                        "passedFilterTypes": [
                            "FAILED_VARIANT_FILTER",
                            "PATHOGENICITY_FILTER",
                            "FREQUENCY_FILTER",
                            "VARIANT_EFFECT_FILTER",
                            "INHERITANCE_FILTER",
                        ],
                        "frequencyData": {
                            "rsId": "rs78052417",
                            "knownFrequencies": [
                                {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                {"source": "TOPMED", "frequency": 0.001133},
                                {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                                {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                            ],
                            "score": 0.9972702,
                        },
                        "pathogenicityData": {
                            "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                            "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                            "score": 0.5581268,
                            "predictedPathogenicityScores": [
                                {"source": "REVEL", "score": 0.348},
                                {"source": "MVP", "score": 0.5581268},
                            ],
                        },
                        "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
                        "contributingInheritanceModes": [
                            "AUTOSOMAL_DOMINANT",
                            "AUTOSOMAL_RECESSIVE",
                        ],
                        "transcriptAnnotations": [
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000251772.4",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2116G>A",
                                "hgvsProtein": "p.(Ala706Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000393409.2",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2185G>A",
                                "hgvsProtein": "p.(Ala729Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                        ],
                    },
                    {
                        "genomeAssembly": "HG19",
                        "contigName": "3",
                        "start": 126741108,
                        "end": 126741108,
                        "ref": "G",
                        "alt": "A",
                        "id": "rs73196567",
                        "type": "SNV",
                        "length": 1,
                        "phredScore": 3055.4399999999996,
                        "variantEffect": "MISSENSE_VARIANT",
                        "filterStatus": "PASSED",
                        "contributesToGeneScore": True,
                        "variantScore": 0.54480255,
                        "frequencyScore": 0.98371375,
                        "pathogenicityScore": 0.5538222,
                        "predictedPathogenic": True,
                        "passedFilterTypes": [
                            "FAILED_VARIANT_FILTER",
                            "PATHOGENICITY_FILTER",
                            "FREQUENCY_FILTER",
                            "VARIANT_EFFECT_FILTER",
                            "INHERITANCE_FILTER",
                        ],
                        "frequencyData": {
                            "rsId": "rs73196567",
                            "knownFrequencies": [
                                {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                {"source": "TOPMED", "frequency": 0.002267},
                                {"source": "EXAC_EAST_ASIAN", "frequency": 0.0116198},
                                {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.0015265311},
                                {"source": "EXAC_OTHER", "frequency": 0.11363637},
                                {"source": "EXAC_SOUTH_ASIAN", "frequency": 0.0060716453},
                                {"source": "GNOMAD_E_EAS", "frequency": 0.01740543},
                                {"source": "GNOMAD_E_NFE", "frequency": 0.0017979468},
                                {"source": "GNOMAD_E_SAS", "frequency": 0.00325013},
                            ],
                            "score": 0.98371375,
                        },
                        "pathogenicityData": {
                            "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                            "mostPathogenicScore": {"source": "MVP", "score": 0.5538222},
                            "score": 0.5538222,
                            "predictedPathogenicityScores": [
                                {"source": "REVEL", "score": 0.301},
                                {"source": "MVP", "score": 0.5538222},
                            ],
                        },
                        "compatibleInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                        "contributingInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                        "transcriptAnnotations": [
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000251772.4",
                                "hgvsGenomic": "g.126741108G>A",
                                "hgvsCdna": "c.4150G>A",
                                "hgvsProtein": "p.(Val1384Met)",
                                "rankType": "EXON",
                                "rank": 21,
                                "rankTotal": 31,
                            },
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000393409.2",
                                "hgvsGenomic": "g.126741108G>A",
                                "hgvsCdna": "c.4219G>A",
                                "hgvsProtein": "p.(Val1407Met)",
                                "rankType": "EXON",
                                "rank": 21,
                                "rankTotal": 31,
                            },
                        ],
                    },
                ],
                "acmgAssignments": [
                    {
                        "variantEvaluation": {
                            "genomeAssembly": "HG19",
                            "contigName": "3",
                            "start": 126730873,
                            "end": 126730873,
                            "ref": "G",
                            "alt": "A",
                            "id": "rs78052417",
                            "type": "SNV",
                            "length": 1,
                            "phredScore": 2970.4399999999996,
                            "variantEffect": "MISSENSE_VARIANT",
                            "filterStatus": "PASSED",
                            "contributesToGeneScore": True,
                            "variantScore": 0.55660325,
                            "frequencyScore": 0.9972702,
                            "pathogenicityScore": 0.5581268,
                            "predictedPathogenic": True,
                            "passedFilterTypes": [
                                "FAILED_VARIANT_FILTER",
                                "PATHOGENICITY_FILTER",
                                "FREQUENCY_FILTER",
                                "VARIANT_EFFECT_FILTER",
                                "INHERITANCE_FILTER",
                            ],
                            "frequencyData": {
                                "rsId": "rs78052417",
                                "knownFrequencies": [
                                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                    {"source": "TOPMED", "frequency": 0.001133},
                                    {
                                        "source": "EXAC_NON_FINNISH_EUROPEAN",
                                        "frequency": 0.004534462,
                                    },
                                    {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                                ],
                                "score": 0.9972702,
                            },
                            "pathogenicityData": {
                                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                                "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                                "score": 0.5581268,
                                "predictedPathogenicityScores": [
                                    {"source": "REVEL", "score": 0.348},
                                    {"source": "MVP", "score": 0.5581268},
                                ],
                            },
                            "compatibleInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "contributingInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "transcriptAnnotations": [
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000251772.4",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2116G>A",
                                    "hgvsProtein": "p.(Ala706Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000393409.2",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2185G>A",
                                    "hgvsProtein": "p.(Ala729Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                            ],
                        },
                        "geneIdentifier": {
                            "geneId": "ENSG00000114554",
                            "geneSymbol": "PLXNA1",
                            "hgncId": "HGNC:9099",
                            "hgncSymbol": "PLXNA1",
                            "entrezId": "5361",
                            "ensemblId": "ENSG00000114554",
                            "ucscId": "uc003ejg.3",
                        },
                        "modeOfInheritance": "AUTOSOMAL_RECESSIVE",
                        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
                        "acmgEvidence": {"empty": True},
                        "acmgClassification": "UNCERTAIN_SIGNIFICANCE",
                    },
                    {
                        "variantEvaluation": {
                            "genomeAssembly": "HG19",
                            "contigName": "3",
                            "start": 126741108,
                            "end": 126741108,
                            "ref": "G",
                            "alt": "A",
                            "id": "rs73196567",
                            "type": "SNV",
                            "length": 1,
                            "phredScore": 3055.4399999999996,
                            "variantEffect": "MISSENSE_VARIANT",
                            "filterStatus": "PASSED",
                            "contributesToGeneScore": True,
                            "variantScore": 0.54480255,
                            "frequencyScore": 0.98371375,
                            "pathogenicityScore": 0.5538222,
                            "predictedPathogenic": True,
                            "passedFilterTypes": [
                                "FAILED_VARIANT_FILTER",
                                "PATHOGENICITY_FILTER",
                                "FREQUENCY_FILTER",
                                "VARIANT_EFFECT_FILTER",
                                "INHERITANCE_FILTER",
                            ],
                            "frequencyData": {
                                "rsId": "rs73196567",
                                "knownFrequencies": [
                                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                    {"source": "TOPMED", "frequency": 0.002267},
                                    {"source": "EXAC_EAST_ASIAN", "frequency": 0.0116198},
                                    {
                                        "source": "EXAC_NON_FINNISH_EUROPEAN",
                                        "frequency": 0.0015265311,
                                    },
                                    {"source": "EXAC_OTHER", "frequency": 0.11363637},
                                    {"source": "EXAC_SOUTH_ASIAN", "frequency": 0.0060716453},
                                    {"source": "GNOMAD_E_EAS", "frequency": 0.01740543},
                                    {"source": "GNOMAD_E_NFE", "frequency": 0.0017979468},
                                    {"source": "GNOMAD_E_SAS", "frequency": 0.00325013},
                                ],
                                "score": 0.98371375,
                            },
                            "pathogenicityData": {
                                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                                "mostPathogenicScore": {"source": "MVP", "score": 0.5538222},
                                "score": 0.5538222,
                                "predictedPathogenicityScores": [
                                    {"source": "REVEL", "score": 0.301},
                                    {"source": "MVP", "score": 0.5538222},
                                ],
                            },
                            "compatibleInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                            "contributingInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                            "transcriptAnnotations": [
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000251772.4",
                                    "hgvsGenomic": "g.126741108G>A",
                                    "hgvsCdna": "c.4150G>A",
                                    "hgvsProtein": "p.(Val1384Met)",
                                    "rankType": "EXON",
                                    "rank": 21,
                                    "rankTotal": 31,
                                },
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000393409.2",
                                    "hgvsGenomic": "g.126741108G>A",
                                    "hgvsCdna": "c.4219G>A",
                                    "hgvsProtein": "p.(Val1407Met)",
                                    "rankType": "EXON",
                                    "rank": 21,
                                    "rankTotal": 31,
                                },
                            ],
                        },
                        "geneIdentifier": {
                            "geneId": "ENSG00000114554",
                            "geneSymbol": "PLXNA1",
                            "hgncId": "HGNC:9099",
                            "hgncSymbol": "PLXNA1",
                            "entrezId": "5361",
                            "ensemblId": "ENSG00000114554",
                            "ucscId": "uc003ejg.3",
                        },
                        "modeOfInheritance": "AUTOSOMAL_RECESSIVE",
                        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
                        "acmgEvidence": {"empty": True},
                        "acmgClassification": "PATHOGENIC",
                    },
                ],
            },
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "X_RECESSIVE",
                "combinedScore": 2.2792733292760184e-05,
                "phenotypeScore": 0.250043917891162,
                "pValue": 0.8396823708206687,
            },
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "X_DOMINANT",
                "combinedScore": 2.2792733292760184e-05,
                "phenotypeScore": 0.250043917891162,
                "pValue": 0.8405273556231003,
            },
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "MITOCHONDRIAL",
                "combinedScore": 2.2792733292760184e-05,
                "phenotypeScore": 0.250043917891162,
                "pValue": 0.8404544072948328,
            },
        ],
        "variantEvaluations": [
            {
                "genomeAssembly": "HG19",
                "contigName": "3",
                "start": 126730873,
                "end": 126730873,
                "ref": "G",
                "alt": "A",
                "id": "rs78052417",
                "type": "SNV",
                "length": 1,
                "phredScore": 2970.4399999999996,
                "variantEffect": "MISSENSE_VARIANT",
                "filterStatus": "PASSED",
                "contributesToGeneScore": True,
                "variantScore": 0.55660325,
                "frequencyScore": 0.9972702,
                "pathogenicityScore": 0.5581268,
                "predictedPathogenic": True,
                "passedFilterTypes": [
                    "FAILED_VARIANT_FILTER",
                    "PATHOGENICITY_FILTER",
                    "FREQUENCY_FILTER",
                    "VARIANT_EFFECT_FILTER",
                    "INHERITANCE_FILTER",
                ],
                "frequencyData": {
                    "rsId": "rs78052417",
                    "knownFrequencies": [
                        {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                        {"source": "TOPMED", "frequency": 0.001133},
                        {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                        {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                    ],
                    "score": 0.9972702,
                },
                "pathogenicityData": {
                    "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                    "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                    "score": 0.5581268,
                    "predictedPathogenicityScores": [
                        {"source": "REVEL", "score": 0.348},
                        {"source": "MVP", "score": 0.5581268},
                    ],
                },
                "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
                "contributingInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
                "transcriptAnnotations": [
                    {
                        "variantEffect": "MISSENSE_VARIANT",
                        "geneSymbol": "PLXNA1",
                        "accession": "ENST00000251772.4",
                        "hgvsGenomic": "g.126730873G>A",
                        "hgvsCdna": "c.2116G>A",
                        "hgvsProtein": "p.(Ala706Thr)",
                        "rankType": "EXON",
                        "rank": 9,
                        "rankTotal": 31,
                    },
                    {
                        "variantEffect": "MISSENSE_VARIANT",
                        "geneSymbol": "PLXNA1",
                        "accession": "ENST00000393409.2",
                        "hgvsGenomic": "g.126730873G>A",
                        "hgvsCdna": "c.2185G>A",
                        "hgvsProtein": "p.(Ala729Thr)",
                        "rankType": "EXON",
                        "rank": 9,
                        "rankTotal": 31,
                    },
                ],
            },
            {
                "genomeAssembly": "HG19",
                "contigName": "3",
                "start": 126741108,
                "end": 126741108,
                "ref": "G",
                "alt": "A",
                "id": "rs73196567",
                "type": "SNV",
                "length": 1,
                "phredScore": 3055.4399999999996,
                "variantEffect": "MISSENSE_VARIANT",
                "filterStatus": "PASSED",
                "contributesToGeneScore": True,
                "variantScore": 0.54480255,
                "frequencyScore": 0.98371375,
                "pathogenicityScore": 0.5538222,
                "predictedPathogenic": True,
                "passedFilterTypes": [
                    "FAILED_VARIANT_FILTER",
                    "PATHOGENICITY_FILTER",
                    "FREQUENCY_FILTER",
                    "VARIANT_EFFECT_FILTER",
                    "INHERITANCE_FILTER",
                ],
                "frequencyData": {
                    "rsId": "rs73196567",
                    "knownFrequencies": [
                        {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                        {"source": "TOPMED", "frequency": 0.002267},
                        {"source": "EXAC_EAST_ASIAN", "frequency": 0.0116198},
                        {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.0015265311},
                        {"source": "EXAC_OTHER", "frequency": 0.11363637},
                        {"source": "EXAC_SOUTH_ASIAN", "frequency": 0.0060716453},
                        {"source": "GNOMAD_E_EAS", "frequency": 0.01740543},
                        {"source": "GNOMAD_E_NFE", "frequency": 0.0017979468},
                        {"source": "GNOMAD_E_SAS", "frequency": 0.00325013},
                    ],
                    "score": 0.98371375,
                },
                "pathogenicityData": {
                    "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                    "mostPathogenicScore": {"source": "MVP", "score": 0.5538222},
                    "score": 0.5538222,
                    "predictedPathogenicityScores": [
                        {"source": "REVEL", "score": 0.301},
                        {"source": "MVP", "score": 0.5538222},
                    ],
                },
                "compatibleInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                "contributingInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                "transcriptAnnotations": [
                    {
                        "variantEffect": "MISSENSE_VARIANT",
                        "geneSymbol": "PLXNA1",
                        "accession": "ENST00000251772.4",
                        "hgvsGenomic": "g.126741108G>A",
                        "hgvsCdna": "c.4150G>A",
                        "hgvsProtein": "p.(Val1384Met)",
                        "rankType": "EXON",
                        "rank": 21,
                        "rankTotal": 31,
                    },
                    {
                        "variantEffect": "MISSENSE_VARIANT",
                        "geneSymbol": "PLXNA1",
                        "accession": "ENST00000393409.2",
                        "hgvsGenomic": "g.126741108G>A",
                        "hgvsCdna": "c.4219G>A",
                        "hgvsProtein": "p.(Val1407Met)",
                        "rankType": "EXON",
                        "rank": 21,
                        "rankTotal": 31,
                    },
                ],
            },
            {
                "genomeAssembly": "HG19",
                "contigName": "3",
                "start": 126747190,
                "end": 126747190,
                "ref": "G",
                "alt": "A",
                "id": "rs73196573",
                "type": "SNV",
                "length": 1,
                "phredScore": 867.44,
                "variantEffect": "SPLICE_REGION_VARIANT",
                "filterStatus": "PASSED",
                "variantScore": 0.44459406,
                "frequencyScore": 0.55574256,
                "pathogenicityScore": 0.8,
                "predictedPathogenic": True,
                "passedFilterTypes": [
                    "FAILED_VARIANT_FILTER",
                    "PATHOGENICITY_FILTER",
                    "FREQUENCY_FILTER",
                    "VARIANT_EFFECT_FILTER",
                    "INHERITANCE_FILTER",
                ],
                "frequencyData": {
                    "rsId": "rs73196573",
                    "knownFrequencies": [
                        {"source": "THOUSAND_GENOMES", "frequency": 0.2995},
                        {"source": "TOPMED", "frequency": 0.7016},
                        {"source": "UK10K", "frequency": 1.4546001},
                        {"source": "ESP_AFRICAN_AMERICAN", "frequency": 0.2502},
                        {"source": "ESP_EUROPEAN_AMERICAN", "frequency": 1.0249},
                        {"source": "ESP_ALL", "frequency": 0.7626},
                        {"source": "EXAC_AFRICAN_INC_AFRICAN_AMERICAN", "frequency": 0.19733596},
                        {"source": "EXAC_AMERICAN", "frequency": 0.2787586},
                        {"source": "EXAC_FINNISH", "frequency": 0.4754938},
                        {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 1.2409139},
                        {"source": "EXAC_OTHER", "frequency": 0.530504},
                        {"source": "EXAC_SOUTH_ASIAN", "frequency": 0.0551572},
                        {"source": "GNOMAD_E_AFR", "frequency": 0.2140411},
                        {"source": "GNOMAD_E_AMR", "frequency": 0.3137948},
                        {"source": "GNOMAD_E_ASJ", "frequency": 0.16163793},
                        {"source": "GNOMAD_E_FIN", "frequency": 0.4726635},
                        {"source": "GNOMAD_E_NFE", "frequency": 1.2459831},
                        {"source": "GNOMAD_E_OTH", "frequency": 0.6594259},
                        {"source": "GNOMAD_E_SAS", "frequency": 0.04284208},
                        {"source": "GNOMAD_G_AFR", "frequency": 0.2522936},
                        {"source": "GNOMAD_G_AMR", "frequency": 0.23866348},
                        {"source": "GNOMAD_G_ASJ", "frequency": 0.33112583},
                        {"source": "GNOMAD_G_FIN", "frequency": 0.744559},
                        {"source": "GNOMAD_G_NFE", "frequency": 1.080288},
                        {"source": "GNOMAD_G_OTH", "frequency": 0.6122449},
                    ],
                    "score": 0.55574256,
                },
                "pathogenicityData": {
                    "clinVarData": {
                        "alleleId": "1547890",
                        "primaryInterpretation": "BENIGN",
                        "reviewStatus": "criteria provided, single submitter",
                    }
                },
                "compatibleInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                "transcriptAnnotations": [
                    {
                        "variantEffect": "SPLICE_REGION_VARIANT",
                        "geneSymbol": "PLXNA1",
                        "accession": "ENST00000251772.4",
                        "hgvsGenomic": "g.126747190G>A",
                        "hgvsCdna": "c.4600+7G>A",
                        "hgvsProtein": "p.?",
                        "rankType": "INTRON",
                        "rank": 24,
                        "rankTotal": 30,
                    },
                    {
                        "variantEffect": "SPLICE_REGION_VARIANT",
                        "geneSymbol": "PLXNA1",
                        "accession": "ENST00000393409.2",
                        "hgvsGenomic": "g.126747190G>A",
                        "hgvsCdna": "c.4669+7G>A",
                        "hgvsProtein": "p.?",
                        "rankType": "INTRON",
                        "rank": 24,
                        "rankTotal": 30,
                    },
                ],
            },
        ],
        "compatibleGeneScores": [
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "AUTOSOMAL_DOMINANT",
                "combinedScore": 0.048419416654489886,
                "phenotypeScore": 0.500087835782324,
                "variantScore": 0.5566032528877258,
                "pValue": 0.18761854103343464,
                "contributingVariants": [
                    {
                        "genomeAssembly": "HG19",
                        "contigName": "3",
                        "start": 126730873,
                        "end": 126730873,
                        "ref": "G",
                        "alt": "A",
                        "id": "rs78052417",
                        "type": "SNV",
                        "length": 1,
                        "phredScore": 2970.4399999999996,
                        "variantEffect": "MISSENSE_VARIANT",
                        "filterStatus": "PASSED",
                        "contributesToGeneScore": True,
                        "variantScore": 0.55660325,
                        "frequencyScore": 0.9972702,
                        "pathogenicityScore": 0.5581268,
                        "predictedPathogenic": True,
                        "passedFilterTypes": [
                            "FAILED_VARIANT_FILTER",
                            "PATHOGENICITY_FILTER",
                            "FREQUENCY_FILTER",
                            "VARIANT_EFFECT_FILTER",
                            "INHERITANCE_FILTER",
                        ],
                        "frequencyData": {
                            "rsId": "rs78052417",
                            "knownFrequencies": [
                                {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                {"source": "TOPMED", "frequency": 0.001133},
                                {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                                {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                            ],
                            "score": 0.9972702,
                        },
                        "pathogenicityData": {
                            "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                            "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                            "score": 0.5581268,
                            "predictedPathogenicityScores": [
                                {"source": "REVEL", "score": 0.348},
                                {"source": "MVP", "score": 0.5581268},
                            ],
                        },
                        "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
                        "contributingInheritanceModes": [
                            "AUTOSOMAL_DOMINANT",
                            "AUTOSOMAL_RECESSIVE",
                        ],
                        "transcriptAnnotations": [
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000251772.4",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2116G>A",
                                "hgvsProtein": "p.(Ala706Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000393409.2",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2185G>A",
                                "hgvsProtein": "p.(Ala729Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                        ],
                    }
                ],
                "acmgAssignments": [
                    {
                        "variantEvaluation": {
                            "genomeAssembly": "HG19",
                            "contigName": "3",
                            "start": 126730873,
                            "end": 126730873,
                            "ref": "G",
                            "alt": "A",
                            "id": "rs78052417",
                            "type": "SNV",
                            "length": 1,
                            "phredScore": 2970.4399999999996,
                            "variantEffect": "MISSENSE_VARIANT",
                            "filterStatus": "PASSED",
                            "contributesToGeneScore": True,
                            "variantScore": 0.55660325,
                            "frequencyScore": 0.9972702,
                            "pathogenicityScore": 0.5581268,
                            "predictedPathogenic": True,
                            "passedFilterTypes": [
                                "FAILED_VARIANT_FILTER",
                                "PATHOGENICITY_FILTER",
                                "FREQUENCY_FILTER",
                                "VARIANT_EFFECT_FILTER",
                                "INHERITANCE_FILTER",
                            ],
                            "frequencyData": {
                                "rsId": "rs78052417",
                                "knownFrequencies": [
                                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                    {"source": "TOPMED", "frequency": 0.001133},
                                    {
                                        "source": "EXAC_NON_FINNISH_EUROPEAN",
                                        "frequency": 0.004534462,
                                    },
                                    {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                                ],
                                "score": 0.9972702,
                            },
                            "pathogenicityData": {
                                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                                "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                                "score": 0.5581268,
                                "predictedPathogenicityScores": [
                                    {"source": "REVEL", "score": 0.348},
                                    {"source": "MVP", "score": 0.5581268},
                                ],
                            },
                            "compatibleInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "contributingInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "transcriptAnnotations": [
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000251772.4",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2116G>A",
                                    "hgvsProtein": "p.(Ala706Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000393409.2",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2185G>A",
                                    "hgvsProtein": "p.(Ala729Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                            ],
                        },
                        "geneIdentifier": {
                            "geneId": "ENSG00000114554",
                            "geneSymbol": "PLXNA1",
                            "hgncId": "HGNC:9099",
                            "hgncSymbol": "PLXNA1",
                            "entrezId": "5361",
                            "ensemblId": "ENSG00000114554",
                            "ucscId": "uc003ejg.3",
                        },
                        "modeOfInheritance": "AUTOSOMAL_DOMINANT",
                        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
                        "acmgEvidence": {"empty": True},
                        "acmgClassification": "LIKELY_PATHOGENIC",
                    }
                ],
            },
            {
                "geneIdentifier": {
                    "geneId": "ENSG00000114554",
                    "geneSymbol": "PLXNA1",
                    "hgncId": "HGNC:9099",
                    "hgncSymbol": "PLXNA1",
                    "entrezId": "5361",
                    "ensemblId": "ENSG00000114554",
                    "ucscId": "uc003ejg.3",
                },
                "modeOfInheritance": "AUTOSOMAL_RECESSIVE",
                "combinedScore": 0.04598293574097189,
                "phenotypeScore": 0.500087835782324,
                "variantScore": 0.5507028996944427,
                "pValue": 0.19066565349544073,
                "contributingVariants": [
                    {
                        "genomeAssembly": "HG19",
                        "contigName": "3",
                        "start": 126730873,
                        "end": 126730873,
                        "ref": "G",
                        "alt": "A",
                        "id": "rs78052417",
                        "type": "SNV",
                        "length": 1,
                        "phredScore": 2970.4399999999996,
                        "variantEffect": "MISSENSE_VARIANT",
                        "filterStatus": "PASSED",
                        "contributesToGeneScore": True,
                        "variantScore": 0.55660325,
                        "frequencyScore": 0.9972702,
                        "pathogenicityScore": 0.5581268,
                        "predictedPathogenic": True,
                        "passedFilterTypes": [
                            "FAILED_VARIANT_FILTER",
                            "PATHOGENICITY_FILTER",
                            "FREQUENCY_FILTER",
                            "VARIANT_EFFECT_FILTER",
                            "INHERITANCE_FILTER",
                        ],
                        "frequencyData": {
                            "rsId": "rs78052417",
                            "knownFrequencies": [
                                {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                {"source": "TOPMED", "frequency": 0.001133},
                                {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                                {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                            ],
                            "score": 0.9972702,
                        },
                        "pathogenicityData": {
                            "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                            "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                            "score": 0.5581268,
                            "predictedPathogenicityScores": [
                                {"source": "REVEL", "score": 0.348},
                                {"source": "MVP", "score": 0.5581268},
                            ],
                        },
                        "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
                        "contributingInheritanceModes": [
                            "AUTOSOMAL_DOMINANT",
                            "AUTOSOMAL_RECESSIVE",
                        ],
                        "transcriptAnnotations": [
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000251772.4",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2116G>A",
                                "hgvsProtein": "p.(Ala706Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000393409.2",
                                "hgvsGenomic": "g.126730873G>A",
                                "hgvsCdna": "c.2185G>A",
                                "hgvsProtein": "p.(Ala729Thr)",
                                "rankType": "EXON",
                                "rank": 9,
                                "rankTotal": 31,
                            },
                        ],
                    },
                    {
                        "genomeAssembly": "HG19",
                        "contigName": "3",
                        "start": 126741108,
                        "end": 126741108,
                        "ref": "G",
                        "alt": "A",
                        "id": "rs73196567",
                        "type": "SNV",
                        "length": 1,
                        "phredScore": 3055.4399999999996,
                        "variantEffect": "MISSENSE_VARIANT",
                        "filterStatus": "PASSED",
                        "contributesToGeneScore": True,
                        "variantScore": 0.54480255,
                        "frequencyScore": 0.98371375,
                        "pathogenicityScore": 0.5538222,
                        "predictedPathogenic": True,
                        "passedFilterTypes": [
                            "FAILED_VARIANT_FILTER",
                            "PATHOGENICITY_FILTER",
                            "FREQUENCY_FILTER",
                            "VARIANT_EFFECT_FILTER",
                            "INHERITANCE_FILTER",
                        ],
                        "frequencyData": {
                            "rsId": "rs73196567",
                            "knownFrequencies": [
                                {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                {"source": "TOPMED", "frequency": 0.002267},
                                {"source": "EXAC_EAST_ASIAN", "frequency": 0.0116198},
                                {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.0015265311},
                                {"source": "EXAC_OTHER", "frequency": 0.11363637},
                                {"source": "EXAC_SOUTH_ASIAN", "frequency": 0.0060716453},
                                {"source": "GNOMAD_E_EAS", "frequency": 0.01740543},
                                {"source": "GNOMAD_E_NFE", "frequency": 0.0017979468},
                                {"source": "GNOMAD_E_SAS", "frequency": 0.00325013},
                            ],
                            "score": 0.98371375,
                        },
                        "pathogenicityData": {
                            "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                            "mostPathogenicScore": {"source": "MVP", "score": 0.5538222},
                            "score": 0.5538222,
                            "predictedPathogenicityScores": [
                                {"source": "REVEL", "score": 0.301},
                                {"source": "MVP", "score": 0.5538222},
                            ],
                        },
                        "compatibleInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                        "contributingInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                        "transcriptAnnotations": [
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000251772.4",
                                "hgvsGenomic": "g.126741108G>A",
                                "hgvsCdna": "c.4150G>A",
                                "hgvsProtein": "p.(Val1384Met)",
                                "rankType": "EXON",
                                "rank": 21,
                                "rankTotal": 31,
                            },
                            {
                                "variantEffect": "MISSENSE_VARIANT",
                                "geneSymbol": "PLXNA1",
                                "accession": "ENST00000393409.2",
                                "hgvsGenomic": "g.126741108G>A",
                                "hgvsCdna": "c.4219G>A",
                                "hgvsProtein": "p.(Val1407Met)",
                                "rankType": "EXON",
                                "rank": 21,
                                "rankTotal": 31,
                            },
                        ],
                    },
                ],
                "acmgAssignments": [
                    {
                        "variantEvaluation": {
                            "genomeAssembly": "HG19",
                            "contigName": "3",
                            "start": 126730873,
                            "end": 126730873,
                            "ref": "G",
                            "alt": "A",
                            "id": "rs78052417",
                            "type": "SNV",
                            "length": 1,
                            "phredScore": 2970.4399999999996,
                            "variantEffect": "MISSENSE_VARIANT",
                            "filterStatus": "PASSED",
                            "contributesToGeneScore": True,
                            "variantScore": 0.55660325,
                            "frequencyScore": 0.9972702,
                            "pathogenicityScore": 0.5581268,
                            "predictedPathogenic": True,
                            "passedFilterTypes": [
                                "FAILED_VARIANT_FILTER",
                                "PATHOGENICITY_FILTER",
                                "FREQUENCY_FILTER",
                                "VARIANT_EFFECT_FILTER",
                                "INHERITANCE_FILTER",
                            ],
                            "frequencyData": {
                                "rsId": "rs78052417",
                                "knownFrequencies": [
                                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                    {"source": "TOPMED", "frequency": 0.001133},
                                    {
                                        "source": "EXAC_NON_FINNISH_EUROPEAN",
                                        "frequency": 0.004534462,
                                    },
                                    {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                                ],
                                "score": 0.9972702,
                            },
                            "pathogenicityData": {
                                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                                "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                                "score": 0.5581268,
                                "predictedPathogenicityScores": [
                                    {"source": "REVEL", "score": 0.348},
                                    {"source": "MVP", "score": 0.5581268},
                                ],
                            },
                            "compatibleInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "contributingInheritanceModes": [
                                "AUTOSOMAL_DOMINANT",
                                "AUTOSOMAL_RECESSIVE",
                            ],
                            "transcriptAnnotations": [
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000251772.4",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2116G>A",
                                    "hgvsProtein": "p.(Ala706Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000393409.2",
                                    "hgvsGenomic": "g.126730873G>A",
                                    "hgvsCdna": "c.2185G>A",
                                    "hgvsProtein": "p.(Ala729Thr)",
                                    "rankType": "EXON",
                                    "rank": 9,
                                    "rankTotal": 31,
                                },
                            ],
                        },
                        "geneIdentifier": {
                            "geneId": "ENSG00000114554",
                            "geneSymbol": "PLXNA1",
                            "hgncId": "HGNC:9099",
                            "hgncSymbol": "PLXNA1",
                            "entrezId": "5361",
                            "ensemblId": "ENSG00000114554",
                            "ucscId": "uc003ejg.3",
                        },
                        "modeOfInheritance": "AUTOSOMAL_RECESSIVE",
                        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
                        "acmgEvidence": {"empty": True},
                        "acmgClassification": "UNCERTAIN_SIGNIFICANCE",
                    },
                    {
                        "variantEvaluation": {
                            "genomeAssembly": "HG19",
                            "contigName": "3",
                            "start": 126741108,
                            "end": 126741108,
                            "ref": "G",
                            "alt": "A",
                            "id": "rs73196567",
                            "type": "SNV",
                            "length": 1,
                            "phredScore": 3055.4399999999996,
                            "variantEffect": "MISSENSE_VARIANT",
                            "filterStatus": "PASSED",
                            "contributesToGeneScore": True,
                            "variantScore": 0.54480255,
                            "frequencyScore": 0.98371375,
                            "pathogenicityScore": 0.5538222,
                            "predictedPathogenic": True,
                            "passedFilterTypes": [
                                "FAILED_VARIANT_FILTER",
                                "PATHOGENICITY_FILTER",
                                "FREQUENCY_FILTER",
                                "VARIANT_EFFECT_FILTER",
                                "INHERITANCE_FILTER",
                            ],
                            "frequencyData": {
                                "rsId": "rs73196567",
                                "knownFrequencies": [
                                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                                    {"source": "TOPMED", "frequency": 0.002267},
                                    {"source": "EXAC_EAST_ASIAN", "frequency": 0.0116198},
                                    {
                                        "source": "EXAC_NON_FINNISH_EUROPEAN",
                                        "frequency": 0.0015265311,
                                    },
                                    {"source": "EXAC_OTHER", "frequency": 0.11363637},
                                    {"source": "EXAC_SOUTH_ASIAN", "frequency": 0.0060716453},
                                    {"source": "GNOMAD_E_EAS", "frequency": 0.01740543},
                                    {"source": "GNOMAD_E_NFE", "frequency": 0.0017979468},
                                    {"source": "GNOMAD_E_SAS", "frequency": 0.00325013},
                                ],
                                "score": 0.98371375,
                            },
                            "pathogenicityData": {
                                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                                "mostPathogenicScore": {"source": "MVP", "score": 0.5538222},
                                "score": 0.5538222,
                                "predictedPathogenicityScores": [
                                    {"source": "REVEL", "score": 0.301},
                                    {"source": "MVP", "score": 0.5538222},
                                ],
                            },
                            "compatibleInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                            "contributingInheritanceModes": ["AUTOSOMAL_RECESSIVE"],
                            "transcriptAnnotations": [
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000251772.4",
                                    "hgvsGenomic": "g.126741108G>A",
                                    "hgvsCdna": "c.4150G>A",
                                    "hgvsProtein": "p.(Val1384Met)",
                                    "rankType": "EXON",
                                    "rank": 21,
                                    "rankTotal": 31,
                                },
                                {
                                    "variantEffect": "MISSENSE_VARIANT",
                                    "geneSymbol": "PLXNA1",
                                    "accession": "ENST00000393409.2",
                                    "hgvsGenomic": "g.126741108G>A",
                                    "hgvsCdna": "c.4219G>A",
                                    "hgvsProtein": "p.(Val1407Met)",
                                    "rankType": "EXON",
                                    "rank": 21,
                                    "rankTotal": 31,
                                },
                            ],
                        },
                        "geneIdentifier": {
                            "geneId": "ENSG00000114554",
                            "geneSymbol": "PLXNA1",
                            "hgncId": "HGNC:9099",
                            "hgncSymbol": "PLXNA1",
                            "entrezId": "5361",
                            "ensemblId": "ENSG00000114554",
                            "ucscId": "uc003ejg.3",
                        },
                        "modeOfInheritance": "AUTOSOMAL_RECESSIVE",
                        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
                        "acmgEvidence": {"empty": True},
                        "acmgClassification": "UNCERTAIN_SIGNIFICANCE",
                    },
                ],
            },
        ],
    }
]

example_exomiser_result_with_disease = [
    {
        "priorityResults": {
            "HIPHIVE_PRIORITY": {
                "priorityType": "HIPHIVE_PRIORITY",
                "geneId": 2639,
                "geneSymbol": "GCDH",
                "score": 0.917458700498875,
                "ppiScore": 0.5504621006548405,
                "queryPhenotypeTerms": [
                    {"id": "HP:0000256", "label": "Macrocephaly"},
                    {"id": "HP:0002059", "label": "Cerebral atrophy"},
                    {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                    {"id": "HP:0003150", "label": "Glutaric aciduria"},
                    {"id": "HP:0001332", "label": "Dystonia"},
                ],
                "phenotypeEvidence": [
                    {
                        "score": 0.917458700498875,
                        "model": {
                            "organism": "HUMAN",
                            "disease": {
                                "diseaseId": "ORPHA:25",
                                "diseaseName": "Glutaryl-CoA dehydrogenase deficiency",
                                "associatedGeneId": 2639,
                                "diseaseType": "DISEASE",
                                "inheritanceMode": "AUTOSOMAL_RECESSIVE",
                                "phenotypeIds": [
                                    "HP:0000573",
                                    "HP:0000726",
                                    "HP:0001251",
                                    "HP:0001260",
                                    "HP:0001334",
                                    "HP:0001337",
                                    "HP:0001373",
                                    "HP:0002015",
                                    "HP:0002063",
                                    "HP:0002072",
                                    "HP:0002086",
                                    "HP:0002119",
                                    "HP:0002275",
                                    "HP:0002305",
                                    "HP:0002315",
                                    "HP:0002321",
                                    "HP:0002339",
                                    "HP:0002376",
                                    "HP:0002451",
                                    "HP:0002500",
                                    "HP:0003150",
                                    "HP:0003162",
                                    "HP:0003546",
                                    "HP:0004481",
                                    "HP:0006829",
                                    "HP:0007132",
                                    "HP:0007185",
                                    "HP:0009716",
                                    "HP:0009830",
                                    "HP:0011968",
                                    "HP:0012379",
                                    "HP:0012469",
                                    "HP:0012622",
                                    "HP:0012704",
                                    "HP:0012753",
                                    "HP:0031982",
                                    "HP:0100309",
                                    "HP:0100954",
                                ],
                                "id": "ORPHA:25",
                                "associatedGeneSymbol": "GCDH",
                            },
                            "entrezGeneId": 2639,
                            "humanGeneSymbol": "GCDH",
                            "diseaseId": "ORPHA:25",
                            "diseaseTerm": "Glutaryl-CoA dehydrogenase deficiency",
                            "phenotypeIds": [
                                "HP:0000573",
                                "HP:0000726",
                                "HP:0001251",
                                "HP:0001260",
                                "HP:0001334",
                                "HP:0001337",
                                "HP:0001373",
                                "HP:0002015",
                                "HP:0002063",
                                "HP:0002072",
                                "HP:0002086",
                                "HP:0002119",
                                "HP:0002275",
                                "HP:0002305",
                                "HP:0002315",
                                "HP:0002321",
                                "HP:0002339",
                                "HP:0002376",
                                "HP:0002451",
                                "HP:0002500",
                                "HP:0003150",
                                "HP:0003162",
                                "HP:0003546",
                                "HP:0004481",
                                "HP:0006829",
                                "HP:0007132",
                                "HP:0007185",
                                "HP:0009716",
                                "HP:0009830",
                                "HP:0011968",
                                "HP:0012379",
                                "HP:0012469",
                                "HP:0012622",
                                "HP:0012704",
                                "HP:0012753",
                                "HP:0031982",
                                "HP:0100309",
                                "HP:0100954",
                            ],
                            "id": "ORPHA:25_2639",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "match": {"id": "HP:0004481", "label": "Progressive macrocephaly"},
                                "lcs": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "ic": 4.408458527505811,
                                "simj": 0.9545454545454546,
                                "score": 2.051359073634555,
                            },
                            {
                                "query": {"id": "HP:0001332", "label": "Dystonia"},
                                "match": {"id": "HP:0002451", "label": "Limb dystonia"},
                                "lcs": {"id": "HP:0001332", "label": "Dystonia"},
                                "ic": 4.3213665907182195,
                                "simj": 0.95,
                                "score": 2.0261535630801304,
                            },
                            {
                                "query": {"id": "HP:0002059", "label": "Cerebral atrophy"},
                                "match": {"id": "HP:0007132", "label": "Pallidal degeneration"},
                                "lcs": {
                                    "id": "HP:0007369",
                                    "label": "Atrophy/Degeneration affecting the cerebrum",
                                },
                                "ic": 4.0355371199046575,
                                "simj": 0.6206896551724138,
                                "score": 1.582661095556815,
                            },
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "lcs": {"id": "MP:0002931"},
                                "ic": 10.492831943969833,
                                "simj": 1.0,
                                "score": 3.239264105313093,
                            },
                            {
                                "query": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "match": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "lcs": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "ic": 9.967317227271051,
                                "simj": 1.0,
                                "score": 3.1571058308633004,
                            },
                        ],
                    },
                    {
                        "score": 0.842713631579757,
                        "model": {
                            "organism": "MOUSE",
                            "entrezGeneId": 2639,
                            "humanGeneSymbol": "GCDH",
                            "modelGeneId": "MGI:104541",
                            "modelGeneSymbol": "Gcdh",
                            "phenotypeIds": [
                                "MP:0001405",
                                "MP:0001523",
                                "MP:0002229",
                                "MP:0002931",
                                "MP:0003068",
                            ],
                            "id": "MGI:104541_MGI:2182958",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0001332", "label": "Dystonia"},
                                "match": {
                                    "id": "MP:0001523",
                                    "label": "impaired righting response",
                                },
                                "lcs": {
                                    "id": "MP:0003492",
                                    "label": "abnormal involuntary movement",
                                },
                                "ic": 3.5458973624846917,
                                "simj": 0.5161290322580645,
                                "score": 1.352826882563193,
                            },
                            {
                                "query": {"id": "HP:0002059", "label": "Cerebral atrophy"},
                                "match": {"id": "MP:0002229", "label": "neurodegeneration"},
                                "lcs": {
                                    "id": "HP:0007367",
                                    "label": "Atrophy/Degeneration affecting the central nervous system",
                                },
                                "ic": 4.612982408378649,
                                "simj": 0.47368421052631576,
                                "score": 1.478207336703692,
                            },
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "MP:0002931", "label": "glutaricadicuria"},
                                "lcs": {"id": "MP:0002931", "label": "glutaricadicuria"},
                                "ic": 11.777112167277982,
                                "simj": 1.0,
                                "score": 3.431779737581942,
                            },
                            {
                                "query": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "match": {"id": "MP:0002229", "label": "neurodegeneration"},
                                "lcs": {
                                    "id": "HP:0002011",
                                    "label": "Morphological central nervous system abnormality",
                                },
                                "ic": 2.572408387118384,
                                "simj": 0.24242424242424243,
                                "score": 0.7896924429503815,
                            },
                        ],
                    },
                ],
                "diseaseMatches": [
                    {
                        "score": 0.917458700498875,
                        "model": {
                            "organism": "HUMAN",
                            "disease": {
                                "diseaseId": "ORPHA:25",
                                "diseaseName": "Glutaryl-CoA dehydrogenase deficiency",
                                "associatedGeneId": 2639,
                                "diseaseType": "DISEASE",
                                "inheritanceMode": "AUTOSOMAL_RECESSIVE",
                                "phenotypeIds": [
                                    "HP:0000573",
                                    "HP:0000726",
                                    "HP:0001251",
                                    "HP:0001260",
                                    "HP:0001334",
                                    "HP:0001337",
                                    "HP:0001373",
                                    "HP:0002015",
                                    "HP:0002063",
                                    "HP:0002072",
                                    "HP:0002086",
                                    "HP:0002119",
                                    "HP:0002275",
                                    "HP:0002305",
                                    "HP:0002315",
                                    "HP:0002321",
                                    "HP:0002339",
                                    "HP:0002376",
                                    "HP:0002451",
                                    "HP:0002500",
                                    "HP:0003150",
                                    "HP:0003162",
                                    "HP:0003546",
                                    "HP:0004481",
                                    "HP:0006829",
                                    "HP:0007132",
                                    "HP:0007185",
                                    "HP:0009716",
                                    "HP:0009830",
                                    "HP:0011968",
                                    "HP:0012379",
                                    "HP:0012469",
                                    "HP:0012622",
                                    "HP:0012704",
                                    "HP:0012753",
                                    "HP:0031982",
                                    "HP:0100309",
                                    "HP:0100954",
                                ],
                                "id": "ORPHA:25",
                                "associatedGeneSymbol": "GCDH",
                            },
                            "entrezGeneId": 2639,
                            "humanGeneSymbol": "GCDH",
                            "diseaseId": "ORPHA:25",
                            "diseaseTerm": "Glutaryl-CoA dehydrogenase deficiency",
                            "phenotypeIds": [
                                "HP:0000573",
                                "HP:0000726",
                                "HP:0001251",
                                "HP:0001260",
                                "HP:0001334",
                                "HP:0001337",
                                "HP:0001373",
                                "HP:0002015",
                                "HP:0002063",
                                "HP:0002072",
                                "HP:0002086",
                                "HP:0002119",
                                "HP:0002275",
                                "HP:0002305",
                                "HP:0002315",
                                "HP:0002321",
                                "HP:0002339",
                                "HP:0002376",
                                "HP:0002451",
                                "HP:0002500",
                                "HP:0003150",
                                "HP:0003162",
                                "HP:0003546",
                                "HP:0004481",
                                "HP:0006829",
                                "HP:0007132",
                                "HP:0007185",
                                "HP:0009716",
                                "HP:0009830",
                                "HP:0011968",
                                "HP:0012379",
                                "HP:0012469",
                                "HP:0012622",
                                "HP:0012704",
                                "HP:0012753",
                                "HP:0031982",
                                "HP:0100309",
                                "HP:0100954",
                            ],
                            "id": "ORPHA:25_2639",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "match": {"id": "HP:0004481", "label": "Progressive macrocephaly"},
                                "lcs": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "ic": 4.408458527505811,
                                "simj": 0.9545454545454546,
                                "score": 2.051359073634555,
                            },
                            {
                                "query": {"id": "HP:0001332", "label": "Dystonia"},
                                "match": {"id": "HP:0002451", "label": "Limb dystonia"},
                                "lcs": {"id": "HP:0001332", "label": "Dystonia"},
                                "ic": 4.3213665907182195,
                                "simj": 0.95,
                                "score": 2.0261535630801304,
                            },
                            {
                                "query": {"id": "HP:0002059", "label": "Cerebral atrophy"},
                                "match": {"id": "HP:0007132", "label": "Pallidal degeneration"},
                                "lcs": {
                                    "id": "HP:0007369",
                                    "label": "Atrophy/Degeneration affecting the cerebrum",
                                },
                                "ic": 4.0355371199046575,
                                "simj": 0.6206896551724138,
                                "score": 1.582661095556815,
                            },
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "lcs": {"id": "MP:0002931"},
                                "ic": 10.492831943969833,
                                "simj": 1.0,
                                "score": 3.239264105313093,
                            },
                            {
                                "query": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "match": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "lcs": {"id": "HP:0100309", "label": "Subdural hemorrhage"},
                                "ic": 9.967317227271051,
                                "simj": 1.0,
                                "score": 3.1571058308633004,
                            },
                        ],
                    },
                    {
                        "score": 0.8440196537772997,
                        "model": {
                            "organism": "HUMAN",
                            "disease": {
                                "diseaseId": "OMIM:231670",
                                "diseaseName": "Glutaricaciduria, type I",
                                "associatedGeneId": 2639,
                                "diseaseType": "DISEASE",
                                "inheritanceMode": "AUTOSOMAL_RECESSIVE",
                                "phenotypeIds": [
                                    "HP:0000007",
                                    "HP:0000238",
                                    "HP:0000256",
                                    "HP:0000750",
                                    "HP:0001250",
                                    "HP:0001252",
                                    "HP:0001263",
                                    "HP:0001264",
                                    "HP:0001266",
                                    "HP:0001290",
                                    "HP:0001298",
                                    "HP:0001332",
                                    "HP:0001508",
                                    "HP:0001942",
                                    "HP:0001943",
                                    "HP:0002063",
                                    "HP:0002179",
                                    "HP:0002240",
                                    "HP:0002919",
                                    "HP:0003150",
                                    "HP:0003530",
                                    "HP:0003593",
                                    "HP:0003621",
                                    "HP:0003623",
                                    "HP:0006873",
                                    "HP:0006956",
                                    "HP:0007105",
                                    "HP:0011463",
                                    "HP:0012448",
                                    "HP:0410175",
                                ],
                                "id": "OMIM:231670",
                                "associatedGeneSymbol": "GCDH",
                            },
                            "entrezGeneId": 2639,
                            "humanGeneSymbol": "GCDH",
                            "diseaseId": "OMIM:231670",
                            "diseaseTerm": "Glutaricaciduria, type I",
                            "phenotypeIds": [
                                "HP:0000007",
                                "HP:0000238",
                                "HP:0000256",
                                "HP:0000750",
                                "HP:0001250",
                                "HP:0001252",
                                "HP:0001263",
                                "HP:0001264",
                                "HP:0001266",
                                "HP:0001290",
                                "HP:0001298",
                                "HP:0001332",
                                "HP:0001508",
                                "HP:0001942",
                                "HP:0001943",
                                "HP:0002063",
                                "HP:0002179",
                                "HP:0002240",
                                "HP:0002919",
                                "HP:0003150",
                                "HP:0003530",
                                "HP:0003593",
                                "HP:0003621",
                                "HP:0003623",
                                "HP:0006873",
                                "HP:0006956",
                                "HP:0007105",
                                "HP:0011463",
                                "HP:0012448",
                                "HP:0410175",
                            ],
                            "id": "OMIM:231670_2639",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "match": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "lcs": {"id": "HP:0000256", "label": "Macrocephaly"},
                                "ic": 4.408458527505811,
                                "simj": 1.0,
                                "score": 2.099632950662046,
                            },
                            {
                                "query": {"id": "HP:0001332", "label": "Dystonia"},
                                "match": {"id": "HP:0001332", "label": "Dystonia"},
                                "lcs": {"id": "HP:0001332", "label": "Dystonia"},
                                "ic": 4.3213665907182195,
                                "simj": 1.0,
                                "score": 2.0787896937204158,
                            },
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "lcs": {"id": "MP:0002931"},
                                "ic": 10.492831943969833,
                                "simj": 1.0,
                                "score": 3.239264105313093,
                            },
                        ],
                    },
                ],
                "ppiEvidence": [
                    {
                        "score": 0.7508174023708145,
                        "model": {
                            "organism": "HUMAN",
                            "disease": {
                                "diseaseId": "ORPHA:35706",
                                "diseaseName": "Glutaric acidemia type 3",
                                "associatedGeneId": 79783,
                                "diseaseType": "DISEASE",
                                "inheritanceMode": "AUTOSOMAL_RECESSIVE",
                                "phenotypeIds": [
                                    "HP:0000960",
                                    "HP:0001254",
                                    "HP:0001263",
                                    "HP:0001328",
                                    "HP:0001508",
                                    "HP:0001993",
                                    "HP:0002518",
                                    "HP:0002919",
                                    "HP:0003150",
                                    "HP:0003530",
                                    "HP:0011021",
                                    "HP:0100710",
                                ],
                                "id": "ORPHA:35706",
                                "associatedGeneSymbol": "SUGCT",
                            },
                            "entrezGeneId": 79783,
                            "humanGeneSymbol": "SUGCT",
                            "diseaseId": "ORPHA:35706",
                            "diseaseTerm": "Glutaric acidemia type 3",
                            "phenotypeIds": [
                                "HP:0000960",
                                "HP:0001254",
                                "HP:0001263",
                                "HP:0001328",
                                "HP:0001508",
                                "HP:0001993",
                                "HP:0002518",
                                "HP:0002919",
                                "HP:0003150",
                                "HP:0003530",
                                "HP:0011021",
                                "HP:0100710",
                            ],
                            "id": "ORPHA:35706_79783",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0002059", "label": "Cerebral atrophy"},
                                "match": {
                                    "id": "HP:0002518",
                                    "label": "Abnormal periventricular white matter morphology",
                                },
                                "lcs": {
                                    "id": "HP:0007367",
                                    "label": "Atrophy/Degeneration affecting the central nervous system",
                                },
                                "ic": 2.86375873649173,
                                "simj": 0.5,
                                "score": 1.1966116196351535,
                            },
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "lcs": {"id": "MP:0002931"},
                                "ic": 10.492831943969833,
                                "simj": 1.0,
                                "score": 3.239264105313093,
                            },
                        ],
                    },
                    {
                        "score": 0.3167280715591734,
                        "model": {
                            "organism": "MOUSE",
                            "entrezGeneId": 79783,
                            "humanGeneSymbol": "SUGCT",
                            "modelGeneId": "MGI:1923221",
                            "modelGeneSymbol": "Sugct",
                            "phenotypeIds": [
                                "MP:0001260",
                                "MP:0001859",
                                "MP:0002135",
                                "MP:0002136",
                                "MP:0002628",
                                "MP:0002705",
                                "MP:0003014",
                                "MP:0003675",
                                "MP:0005425",
                                "MP:0009115",
                                "MP:0009640",
                                "MP:0010377",
                                "MP:0010999",
                                "MP:0013245",
                                "MP:0020386",
                            ],
                            "id": "MGI:1923221_MGI:6456764",
                        },
                        "bestModelPhenotypeMatches": [
                            {
                                "query": {"id": "HP:0003150", "label": "Glutaric aciduria"},
                                "match": {
                                    "id": "MP:0002136",
                                    "label": "abnormal kidney physiology",
                                },
                                "lcs": {
                                    "id": "MP:0005502",
                                    "label": "abnormal renal/urinary system physiology",
                                },
                                "ic": 4.554035059169369,
                                "simj": 0.3076923076923077,
                                "score": 1.1837404938023783,
                            }
                        ],
                    },
                ],
                "humanScore": 0.917458700498875,
                "mouseScore": 0.842713631579757,
            },
            "OMIM_PRIORITY": {
                "priorityType": "OMIM_PRIORITY",
                "geneId": 2639,
                "geneSymbol": "GCDH",
                "score": 1.0,
                "scoresByMode": {
                    "AUTOSOMAL_DOMINANT": 0.5,
                    "AUTOSOMAL_RECESSIVE": 1.0,
                    "X_RECESSIVE": 0.5,
                    "X_DOMINANT": 0.5,
                    "MITOCHONDRIAL": 0.5,
                },
                "associatedDiseases": [
                    {
                        "diseaseId": "OMIM:231670",
                        "diseaseName": "Glutaricaciduria, type I",
                        "associatedGeneId": 2639,
                        "diseaseType": "DISEASE",
                        "inheritanceMode": "AUTOSOMAL_RECESSIVE",
                        "phenotypeIds": [
                            "HP:0000007",
                            "HP:0000238",
                            "HP:0000256",
                            "HP:0000750",
                            "HP:0001250",
                            "HP:0001252",
                            "HP:0001263",
                            "HP:0001264",
                            "HP:0001266",
                            "HP:0001290",
                            "HP:0001298",
                            "HP:0001332",
                            "HP:0001508",
                            "HP:0001942",
                            "HP:0001943",
                            "HP:0002063",
                            "HP:0002179",
                            "HP:0002240",
                            "HP:0002919",
                            "HP:0003150",
                            "HP:0003530",
                            "HP:0003593",
                            "HP:0003621",
                            "HP:0003623",
                            "HP:0006873",
                            "HP:0006956",
                            "HP:0007105",
                            "HP:0011463",
                            "HP:0012448",
                            "HP:0410175",
                        ],
                        "id": "OMIM:231670",
                        "associatedGeneSymbol": "GCDH",
                    },
                    {
                        "diseaseId": "ORPHA:25",
                        "diseaseName": "Glutaryl-CoA dehydrogenase deficiency",
                        "associatedGeneId": 2639,
                        "diseaseType": "DISEASE",
                        "inheritanceMode": "AUTOSOMAL_RECESSIVE",
                        "phenotypeIds": [
                            "HP:0000573",
                            "HP:0000726",
                            "HP:0001251",
                            "HP:0001260",
                            "HP:0001334",
                            "HP:0001337",
                            "HP:0001373",
                            "HP:0002015",
                            "HP:0002063",
                            "HP:0002072",
                            "HP:0002086",
                            "HP:0002119",
                            "HP:0002275",
                            "HP:0002305",
                            "HP:0002315",
                            "HP:0002321",
                            "HP:0002339",
                            "HP:0002376",
                            "HP:0002451",
                            "HP:0002500",
                            "HP:0003150",
                            "HP:0003162",
                            "HP:0003546",
                            "HP:0004481",
                            "HP:0006829",
                            "HP:0007132",
                            "HP:0007185",
                            "HP:0009716",
                            "HP:0009830",
                            "HP:0011968",
                            "HP:0012379",
                            "HP:0012469",
                            "HP:0012622",
                            "HP:0012704",
                            "HP:0012753",
                            "HP:0031982",
                            "HP:0100309",
                            "HP:0100954",
                        ],
                        "id": "ORPHA:25",
                        "associatedGeneSymbol": "GCDH",
                    },
                ],
            },
        }
    }
]

variant_acmg_pathogenic = [
    {
        "variantEvaluation": {
            "genomeAssembly": "HG19",
            "contigName": "3",
            "start": 126730873,
            "end": 126730873,
            "ref": "G",
            "alt": "A",
            "id": "rs78052417",
            "type": "SNV",
            "length": 1,
            "phredScore": 2970.4399999999996,
            "variantEffect": "MISSENSE_VARIANT",
            "filterStatus": "PASSED",
            "contributesToGeneScore": True,
            "variantScore": 0.55660325,
            "frequencyScore": 0.9972702,
            "pathogenicityScore": 0.5581268,
            "predictedPathogenic": True,
            "passedFilterTypes": [
                "FAILED_VARIANT_FILTER",
                "PATHOGENICITY_FILTER",
                "FREQUENCY_FILTER",
                "VARIANT_EFFECT_FILTER",
                "INHERITANCE_FILTER",
            ],
            "frequencyData": {
                "rsId": "rs78052417",
                "knownFrequencies": [
                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                    {"source": "TOPMED", "frequency": 0.001133},
                    {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                    {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                ],
                "score": 0.9972702,
            },
            "pathogenicityData": {
                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                "score": 0.5581268,
                "predictedPathogenicityScores": [
                    {"source": "REVEL", "score": 0.348},
                    {"source": "MVP", "score": 0.5581268},
                ],
            },
            "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
            "contributingInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
            "transcriptAnnotations": [
                {
                    "variantEffect": "MISSENSE_VARIANT",
                    "geneSymbol": "PLXNA1",
                    "accession": "ENST00000251772.4",
                    "hgvsGenomic": "g.126730873G>A",
                    "hgvsCdna": "c.2116G>A",
                    "hgvsProtein": "p.(Ala706Thr)",
                    "rankType": "EXON",
                    "rank": 9,
                    "rankTotal": 31,
                },
                {
                    "variantEffect": "MISSENSE_VARIANT",
                    "geneSymbol": "PLXNA1",
                    "accession": "ENST00000393409.2",
                    "hgvsGenomic": "g.126730873G>A",
                    "hgvsCdna": "c.2185G>A",
                    "hgvsProtein": "p.(Ala729Thr)",
                    "rankType": "EXON",
                    "rank": 9,
                    "rankTotal": 31,
                },
            ],
        },
        "geneIdentifier": {
            "geneId": "ENSG00000114554",
            "geneSymbol": "PLXNA1",
            "hgncId": "HGNC:9099",
            "hgncSymbol": "PLXNA1",
            "entrezId": "5361",
            "ensemblId": "ENSG00000114554",
            "ucscId": "uc003ejg.3",
        },
        "modeOfInheritance": "AUTOSOMAL_DOMINANT",
        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
        "acmgEvidence": {"empty": True},
        "acmgClassification": "PATHOGENIC",
    }
]
variant_acmg_uncertain_significance = [
    {
        "variantEvaluation": {
            "genomeAssembly": "HG19",
            "contigName": "3",
            "start": 126730873,
            "end": 126730873,
            "ref": "G",
            "alt": "A",
            "id": "rs78052417",
            "type": "SNV",
            "length": 1,
            "phredScore": 2970.4399999999996,
            "variantEffect": "MISSENSE_VARIANT",
            "filterStatus": "PASSED",
            "contributesToGeneScore": True,
            "variantScore": 0.55660325,
            "frequencyScore": 0.9972702,
            "pathogenicityScore": 0.5581268,
            "predictedPathogenic": True,
            "passedFilterTypes": [
                "FAILED_VARIANT_FILTER",
                "PATHOGENICITY_FILTER",
                "FREQUENCY_FILTER",
                "VARIANT_EFFECT_FILTER",
                "INHERITANCE_FILTER",
            ],
            "frequencyData": {
                "rsId": "rs78052417",
                "knownFrequencies": [
                    {"source": "THOUSAND_GENOMES", "frequency": 0.01997},
                    {"source": "TOPMED", "frequency": 0.001133},
                    {"source": "EXAC_NON_FINNISH_EUROPEAN", "frequency": 0.004534462},
                    {"source": "GNOMAD_E_NFE", "frequency": 0.0035905354},
                ],
                "score": 0.9972702,
            },
            "pathogenicityData": {
                "clinVarData": {"primaryInterpretation": "NOT_PROVIDED"},
                "mostPathogenicScore": {"source": "MVP", "score": 0.5581268},
                "score": 0.5581268,
                "predictedPathogenicityScores": [
                    {"source": "REVEL", "score": 0.348},
                    {"source": "MVP", "score": 0.5581268},
                ],
            },
            "compatibleInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
            "contributingInheritanceModes": ["AUTOSOMAL_DOMINANT", "AUTOSOMAL_RECESSIVE"],
            "transcriptAnnotations": [
                {
                    "variantEffect": "MISSENSE_VARIANT",
                    "geneSymbol": "PLXNA1",
                    "accession": "ENST00000251772.4",
                    "hgvsGenomic": "g.126730873G>A",
                    "hgvsCdna": "c.2116G>A",
                    "hgvsProtein": "p.(Ala706Thr)",
                    "rankType": "EXON",
                    "rank": 9,
                    "rankTotal": 31,
                },
                {
                    "variantEffect": "MISSENSE_VARIANT",
                    "geneSymbol": "PLXNA1",
                    "accession": "ENST00000393409.2",
                    "hgvsGenomic": "g.126730873G>A",
                    "hgvsCdna": "c.2185G>A",
                    "hgvsProtein": "p.(Ala729Thr)",
                    "rankType": "EXON",
                    "rank": 9,
                    "rankTotal": 31,
                },
            ],
        },
        "geneIdentifier": {
            "geneId": "ENSG00000114554",
            "geneSymbol": "PLXNA1",
            "hgncId": "HGNC:9099",
            "hgncSymbol": "PLXNA1",
            "entrezId": "5361",
            "ensemblId": "ENSG00000114554",
            "ucscId": "uc003ejg.3",
        },
        "modeOfInheritance": "AUTOSOMAL_DOMINANT",
        "disease": {"diseaseType": "UNCONFIRMED", "inheritanceMode": "UNKNOWN"},
        "acmgEvidence": {"empty": True},
        "acmgClassification": "UNCERTAIN_SIGNIFICANCE",
    }
]


class TestPhEvalGeneResultFromExomiserJsonCreator(unittest.TestCase):
    @classmethod
    def setUpClass(cls) -> None:
        cls.json_result = PhEvalGeneResultFromExomiserJsonCreator(
            example_exomiser_result, "combinedScore"
        )

    def test_find_gene_symbol(self):
        self.assertEqual(
            self.json_result._find_gene_symbol(result_entry=example_exomiser_result[0]), "PLXNA1"
        )

    def test_find_gene_identifier(self):
        self.assertEqual(
            self.json_result._find_gene_identifier(result_entry=example_exomiser_result[0]),
            "ENSG00000114554",
        )

    def test_find_relevant_score(self):
        self.assertEqual(
            self.json_result._find_relevant_score(result_entry=example_exomiser_result[0]), 0.0484
        )

    def test_extract_pheval_gene_requirements(self):
        self.assertEqual(
            self.json_result.extract_pheval_gene_requirements(),
            [
                PhEvalGeneResult(
                    gene_symbol="PLXNA1", gene_identifier="ENSG00000114554", score=0.0484
                )
            ],
        )


class TestPhEvalVariantFromExomiserJsonCreator(unittest.TestCase):
    @classmethod
    def setUpClass(cls) -> None:
        cls.json_result = PhEvalVariantResultFromExomiserJsonCreator(
            exomiser_json_result=example_exomiser_result, score_name="combinedScore"
        )
        cls.result_entry = example_exomiser_result[0]["geneScores"][0]["contributingVariants"][0]

    def test_find_chromosome(self):
        self.assertEqual(self.json_result._find_chromosome(result_entry=self.result_entry), "3")

    def test_find_start_pos(self):
        self.assertEqual(
            self.json_result._find_start_pos(result_entry=self.result_entry), 126730873
        )

    def test_find_end_pos(self):
        self.assertEqual(self.json_result._find_end_pos(result_entry=self.result_entry), 126730873)

    def test_find_ref(self):
        self.assertEqual(self.json_result._find_ref(result_entry=self.result_entry), "G")

    def test_find_alt(self):
        self.assertEqual(self.json_result._find_alt(result_entry=self.result_entry), "A")

    def test_find_alt_sv(self):
        copied_result_entry = copy(dict(self.result_entry))
        copied_result_entry["alt"] = "<DEL>"
        self.assertEqual(self.json_result._find_alt(result_entry=copied_result_entry), "DEL")

    def test_find_alt_none(self):
        copied_result_entry = copy(dict(self.result_entry))
        copied_result_entry["alt"] = None
        self.assertEqual(self.json_result._find_alt(result_entry=copied_result_entry), "")

    def test_find_relevant_score(self):
        self.assertEqual(
            self.json_result._find_relevant_score(
                result_entry=example_exomiser_result[0]["geneScores"][0]
            ),
            0.0484,
        )

    def test__filter_for_acmg_assignments_pathogenic(self):
        self.assertTrue(
            self.json_result._filter_for_acmg_assignments(
                PhEvalVariantResult(
                    chromosome="3", start=126730873, end=126730873, ref="G", alt="A", score=0.0484
                ),
                score=0.0484,
                variant_acmg_assignments=variant_acmg_pathogenic,
            )
        )

    def test__filter_for_acmg_assignments_uncertain_significance(self):
        self.assertFalse(
            self.json_result._filter_for_acmg_assignments(
                PhEvalVariantResult(
                    chromosome="3", start=126730873, end=126730873, ref="G", alt="A", score=0.0484
                ),
                score=0.0484,
                variant_acmg_assignments=variant_acmg_uncertain_significance,
            )
        )

    @patch.object(
        PhEvalVariantResultFromExomiserJsonCreator,
        "add_or_find_variant_group",
        return_value="mocked_id",
    )
    def test_extract_pheval_variant_requirements(self, mock_add_or_find_variant_group):
        self.assertEqual(
            self.json_result.extract_pheval_variant_requirements(),
            [
                PhEvalVariantResult(
                    chromosome="3",
                    start=126730873,
                    end=126730873,
                    ref="G",
                    alt="A",
                    score=0.0484,
                    grouping_id="mocked_id",
                ),
                PhEvalVariantResult(
                    chromosome="3",
                    start=126730873,
                    end=126730873,
                    ref="G",
                    alt="A",
                    score=0.0484,
                    grouping_id="mocked_id",
                ),
                PhEvalVariantResult(
                    chromosome="3",
                    start=126741108,
                    end=126741108,
                    ref="G",
                    alt="A",
                    score=0.0484,
                    grouping_id="mocked_id",
                ),
            ],
        )

    @patch.object(
        PhEvalVariantResultFromExomiserJsonCreator,
        "add_or_find_variant_group",
        return_value="mocked_id",
    )
    def test_extract_pheval_variant_requirements_filter_acmg(self, mock_add_or_find_variant_group):
        self.assertEqual(
            self.json_result.extract_pheval_variant_requirements(True),
            [
                PhEvalVariantResult(
                    chromosome="3",
                    start=126730873,
                    end=126730873,
                    ref="G",
                    alt="A",
                    score=0.0484,
                    grouping_id="mocked_id",
                ),
                PhEvalVariantResult(
                    chromosome="3",
                    start=126741108,
                    end=126741108,
                    ref="G",
                    alt="A",
                    score=0.0484,
                    grouping_id="mocked_id",
                ),
            ],
        )


class TestPhEvalDiseaseResultFromExomiserJsonCreator(unittest.TestCase):
    @classmethod
    def setUpClass(cls) -> None:
        cls.json_result = PhEvalDiseaseResultFromExomiserJsonCreator(
            example_exomiser_result_with_disease,
        )

    def test__find_disease_name(self):
        self.assertEqual(
            self.json_result._find_disease_name(
                result_entry=example_exomiser_result_with_disease[0]["priorityResults"][
                    "HIPHIVE_PRIORITY"
                ]["diseaseMatches"][0]["model"]
            ),
            "Glutaryl-CoA dehydrogenase deficiency",
        )

    def test__find_disease_identifier(self):
        self.assertEqual(
            self.json_result._find_disease_identifier(
                result_entry=example_exomiser_result_with_disease[0]["priorityResults"][
                    "HIPHIVE_PRIORITY"
                ]["diseaseMatches"][0]["model"]
            ),
            "ORPHA:25",
        )

    def test__find_relevant_score(self):
        self.assertEqual(
            self.json_result._find_relevant_score(
                result_entry=example_exomiser_result_with_disease[0]["priorityResults"][
                    "HIPHIVE_PRIORITY"
                ]["diseaseMatches"][0]
            ),
            0.9175,
        )

    def test_extract_pheval_gene_requirements(self):
        self.assertEqual(
            self.json_result.extract_pheval_disease_requirements(),
            [
                PhEvalDiseaseResult(
                    disease_name="Glutaryl-CoA dehydrogenase deficiency",
                    disease_identifier="ORPHA:25",
                    score=0.9175,
                ),
                PhEvalDiseaseResult(
                    disease_name="Glutaricaciduria, type I",
                    disease_identifier="OMIM:231670",
                    score=0.844,
                ),
            ],
        )
